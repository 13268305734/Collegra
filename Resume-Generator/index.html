<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">简历生成器</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(
                135deg,
                #d6e4ff 0%,
                #c3dafe 25%,
                #e0d2ff 50%,
                #f4d2e0 75%,
                #e0f0ff 100%
            );
            background-size: 200% 200%;
            animation: gradientShift 15s ease-in-out infinite;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        .form-section {
            margin-bottom: 20px;
        }
        .entry {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        .extra-field {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        .extra-field input {
            width: 48%;
        }
        #output {
            margin-top: 20px;
            padding: 15px;
            background: #f1f5f9;
            border-radius: 8px;
            color: #1f2937;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <h1 id="page-title" class="text-3xl font-bold text-gray-800 mb-6">简历生成器</h1>
    <div class="container">
        <form id="cvForm" class="w-full">
            <!-- Language Selection -->
            <div class="form-section">
                <label for="language" data-i18n="language_label" class="block text-sm font-medium text-gray-700 mb-2">语言</label>
                <select id="language" name="language" onchange="updateLanguage()" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                    <option value="ch" selected>中文 (Chinese)</option>
                    <option value="en">English</option>
                </select>
            </div>

            <!-- Personal Information -->
            <div class="form-section">
                <h2 data-i18n="personal_info" class="text-xl font-semibold text-gray-800 mb-4">个人信息</h2>
                <div class="mb-4">
                    <label for="name" data-i18n="name_label" class="block text-sm font-medium text-gray-700 mb-2">姓名</label>
                    <input type="text" id="name" name="Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：张伟">
                </div>
                <div class="mb-4">
                    <label for="location" data-i18n="location_label" class="block text-sm font-medium text-gray-700 mb-2">地点</label>
                    <input type="text" id="location" name="Location" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：中国广州">
                </div>
                <div class="mb-4">
                    <label for="email" data-i18n="email_label" class="block text-sm font-medium text-gray-700 mb-2">电子邮件</label>
                    <input type="text" id="email" name="Email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：zhangwei@example.com">
                </div>
            </div>

            <!-- Education -->
            <div class="form-section">
                <h2 data-i18n="education" class="text-xl font-semibold text-gray-800 mb-4">教育经历</h2>
                <div id="educationEntries">
                    <div class="entry">
                        <div class="mb-4">
                            <label data-i18n="institution_label" class="block text-sm font-medium text-gray-700 mb-2">机构</label>
                            <input type="text" name="education_institution" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：中山大学">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="duration_label" class="block text-sm font-medium text-gray-700 mb-2">时间段</label>
                            <input type="text" name="education_duration" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：2023年9月 - 至今">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="degree_label" class="block text-sm font-medium text-gray-700 mb-2">学位</label>
                            <input type="text" name="education_degree" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：计算机科学与技术学士">
                        </div>
                        <div class="extra-fields" data-i18n="extra_fields_label" class="text-sm font-medium text-gray-700 mb-2">额外信息（可选）</div>
                        <div class="extra-container"></div>
                        <button type="button" data-i18n="add_extra" onclick="addExtraField(this)" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加额外信息</button>
                        <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="mt-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
                    </div>
                </div>
                <button type="button" data-i18n="add_education" onclick="addEducation()" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加教育经历</button>
            </div>

            <!-- Experience -->
            <div class="form-section">
                <h2 data-i18n="experience" class="text-xl font-semibold text-gray-800 mb-4">工作经历</h2>
                <div id="experienceEntries">
                    <div class="entry">
                        <div class="mb-4">
                            <label data-i18n="affiliation_label" class="block text-sm font-medium text-gray-700 mb-2">隶属机构</label>
                            <input type="text" name="experience_affiliation" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：中山大学">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="location_label" class="block text-sm font-medium text-gray-700 mb-2">地点</label>
                            <input type="text" name="experience_location" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：中国广州">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="duration_label" class="block text-sm font-medium text-gray-700 mb-2">时间段</label>
                            <input type="text" name="experience_duration" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：2024年6月 - 至今">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="position_label" class="block text-sm font-medium text-gray-700 mb-2">职位</label>
                            <input type="text" name="experience_position" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：研究助理">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="descriptions_label" class="block text-sm font-medium text-gray-700 mb-2">描述（每行一条）</label>
                            <textarea name="experience_descriptions" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：开发AI模型\n发表研究"></textarea>
                        </div>
                        <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
                    </div>
                </div>
                <button type="button" data-i18n="add_experience" onclick="addExperience()" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加工作经历</button>
            </div>

            <!-- Publications -->
            <div class="form-section">
                <h2 data-i18n="publications" class="text-xl font-semibold text-gray-800 mb-4">论文发表</h2>
                <div id="publicationEntries">
                    <div class="entry">
                        <div class="mb-4">
                            <label data-i18n="authors_label" class="block text-sm font-medium text-gray-700 mb-2">作者（逗号分隔）</label>
                            <input type="text" name="publication_authors" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：张伟, 李明">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="title_label" class="block text-sm font-medium text-gray-700 mb-2">标题</label>
                            <input type="text" name="publication_title" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：人工智能进展">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="venue_label" class="block text-sm font-medium text-gray-700 mb-2">出版物</label>
                            <input type="text" name="publication_venue" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：NeurIPS">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="year_label" class="block text-sm font-medium text-gray-700 mb-2">年份</label>
                            <input type="text" name="publication_year" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：2025">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="url_label" class="block text-sm font-medium text-gray-700 mb-2">网址（可选）</label>
                            <input type="text" name="publication_url" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：https://arxiv.org/abs/1234.5678">
                        </div>
                        <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
                    </div>
                </div>
                <button type="button" data-i18n="add_publication" onclick="addPublication()" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加论文</button>
            </div>

            <!-- Projects -->
            <div class="form-section">
                <h2 data-i18n="projects" class="text-xl font-semibold text-gray-800 mb-4">项目</h2>
                <div id="projectEntries">
                    <div class="entry">
                        <div class="mb-4">
                            <label data-i18n="title_label" class="block text-sm font-medium text-gray-700 mb-2">标题</label>
                            <input type="text" name="project_title" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：AI图像生成项目">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="descriptions_label" class="block text-sm font-medium text-gray-700 mb-2">描述（每行一条）</label>
                            <textarea name="project_descriptions" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：构建神经网络\n获奖"></textarea>
                        </div>
                        <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
                    </div>
                </div>
                <button type="button" data-i18n="add_project" onclick="addProject()" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加项目</button>
            </div>

            <!-- Skills -->
            <div class="form-section">
                <h2 data-i18n="skills" class="text-xl font-semibold text-gray-800 mb-4">技能</h2>
                <div id="skillEntries">
                    <div class="entry">
                        <div class="mb-4">
                            <label data-i18n="category_label" class="block text-sm font-medium text-gray-700 mb-2">类别</label>
                            <input type="text" name="skill_category" data-i18n-placeholder="category_placeholder" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：编程语言">
                        </div>
                        <div class="mb-4">
                            <label data-i18n="items_label" class="block text-sm font-medium text-gray-700 mb-2">项目</label>
                            <input type="text" name="skill_items" data-i18n-placeholder="items_placeholder" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：Python, Java">
                        </div>
                        <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
                    </div>
                </div>
                <button type="button" data-i18n="add_skill" onclick="addSkill()" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加技能类别</button>
            </div>

            <button type="submit" data-i18n="generate_cv" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">生成简历</button>
        </form>
        <div id="output" class="hidden"></div>
    </div>

    <script>
        // Translation dictionary
        const translations = {
            en: {
                title: "CV Generator",
                language_label: "Language",
                personal_info: "Personal Information",
                name_label: "Name",
                location_label: "Location",
                email_label: "Email",
                education: "Education",
                institution_label: "Institution",
                duration_label: "Duration",
                degree_label: "Degree",
                extra_fields_label: "Extra Details (Optional)",
                add_extra: "Add Extra Detail",
                add_education: "Add Education",
                experience: "Experience",
                affiliation_label: "Affiliation",
                position_label: "Position",
                descriptions_label: "Descriptions (one per line)",
                add_experience: "Add Experience",
                publications: "Publications",
                authors_label: "Authors (comma-separated)",
                title_label: "Title",
                venue_label: "Venue",
                year_label: "Year",
                url_label: "URL (Optional)",
                add_publication: "Add Publication",
                projects: "Projects",
                add_project: "Add Project",
                skills: "Skills",
                category_label: "Category",
                category_placeholder: "e.g., Programming Languages",
                items_label: "Items",
                items_placeholder: "e.g., C/C++, Python, Java",
                add_skill: "Add Skill Category",
                remove_button: "Remove",
                generate_cv: "Generate CV",
                extra_key_placeholder: "e.g., GPA",
                extra_value_placeholder: "e.g., 4.0/4.0",
                success_message: "CV generated successfully! Check your downloads.",
                error_message: "Error: "
            },
            ch: {
                title: "简历生成器",
                language_label: "语言",
                personal_info: "个人信息",
                name_label: "姓名",
                location_label: "地点",
                email_label: "电子邮件",
                education: "教育经历",
                institution_label: "机构",
                duration_label: "时间段",
                degree_label: "学位",
                extra_fields_label: "额外信息（可选）",
                add_extra: "添加额外信息",
                add_education: "添加教育经历",
                experience: "工作经历",
                affiliation_label: "隶属机构",
                position_label: "职位",
                descriptions_label: "描述（每行一条）",
                add_experience: "添加工作经历",
                publications: "论文发表",
                authors_label: "作者（逗号分隔）",
                title_label: "标题",
                venue_label: "出版物",
                year_label: "年份",
                url_label: "网址（可选）",
                add_publication: "添加论文",
                projects: "项目",
                add_project: "添加项目",
                skills: "技能",
                category_label: "类别",
                category_placeholder: "例如：编程语言",
                items_label: "项目",
                items_placeholder: "例如：Python, Java",
                add_skill: "添加技能类别",
                remove_button: "移除",
                generate_cv: "生成简历",
                extra_key_placeholder: "例如：GPA",
                extra_value_placeholder: "例如：4.0/4.0",
                success_message: "简历生成成功！请检查您的下载内容。",
                error_message: "错误："
            }
        };

        // Update language based on selection
        function updateLanguage() {
            const lang = document.getElementById('language').value;
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.textContent = translations[lang][key] || el.textContent;
            });
            const placeholders = document.querySelectorAll('[data-i18n-placeholder]');
            placeholders.forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                el.placeholder = translations[lang][key] || el.placeholder;
            });
            document.getElementById('page-title').textContent = translations[lang].title;
        }

        // Initialize language on page load
        document.addEventListener('DOMContentLoaded', updateLanguage);

        function addExtraField(button) {
            const container = button.parentElement.querySelector('.extra-container');
            const extraField = document.createElement('div');
            extraField.className = 'extra-field';
            extraField.innerHTML = `
                <input type="text" name="education_extra_key" data-i18n-placeholder="extra_key_placeholder" placeholder="${translations.ch.extra_key_placeholder}" class="w-1/2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                <input type="text" name="education_extra_value" data-i18n-placeholder="extra_value_placeholder" placeholder="${translations.ch.extra_value_placeholder}" class="w-1/2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                <button type="button" data-i18n="remove_button" onclick="this.parentElement.remove(); updateLanguage()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
            `;
            container.appendChild(extraField);
            updateLanguage();
        }

        function addEducation() {
            const container = document.getElementById('educationEntries');
            const entry = document.createElement('div');
            entry.className = 'entry';
            entry.innerHTML = `
                <div class="mb-4">
                    <label data-i18n="institution_label" class="block text-sm font-medium text-gray-700 mb-2">机构</label>
                    <input type="text" name="education_institution" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：中山大学">
                </div>
                <div class="mb-4">
                    <label data-i18n="duration_label" class="block text-sm font-medium text-gray-700 mb-2">时间段</label>
                    <input type="text" name="education_duration" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：2023年9月 - 至今">
                </div>
                <div class="mb-4">
                    <label data-i18n="degree_label" class="block text-sm font-medium text-gray-700 mb-2">学位</label>
                    <input type="text" name="education_degree" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：计算机科学与技术学士">
                </div>
                <div class="extra-fields" data-i18n="extra_fields_label" class="text-sm font-medium text-gray-700 mb-2">额外信息（可选）</div>
                <div class="extra-container"></div>
                <button type="button" data-i18n="add_extra" onclick="addExtraField(this)" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加额外信息</button>
                <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="mt-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
            `;
            container.appendChild(entry);
            updateLanguage();
        }

        function addExperience() {
            const container = document.getElementById('experienceEntries');
            const entry = document.createElement('div');
            entry.className = 'entry';
            entry.innerHTML = `
                <div class="mb-4">
                    <label data-i18n="affiliation_label" class="block text-sm font-medium text-gray-700 mb-2">隶属机构</label>
                    <input type="text" name="experience_affiliation" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：中山大学">
                </div>
                <div class="mb-4">
                    <label data-i18n="location_label" class="block text-sm font-medium text-gray-700 mb-2">地点</label>
                    <input type="text" name="experience_location" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：中国广州">
                </div>
                <div class="mb-4">
                    <label data-i18n="duration_label" class="block text-sm font-medium text-gray-700 mb-2">时间段</label>
                    <input type="text" name="experience_duration" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：2024年6月 - 至今">
                </div>
                <div class="mb-4">
                    <label data-i18n="position_label" class="block text-sm font-medium text-gray-700 mb-2">职位</label>
                    <input type="text" name="experience_position" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：研究助理">
                </div>
                <div class="mb-4">
                    <label data-i18n="descriptions_label" class="block text-sm font-medium text-gray-700 mb-2">描述（每行一条）</label>
                    <textarea name="experience_descriptions" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：开发AI模型\n发表研究"></textarea>
                </div>
                <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
            `;
            container.appendChild(entry);
            updateLanguage();
        }

        function addPublication() {
            const container = document.getElementById('publicationEntries');
            const entry = document.createElement('div');
            entry.className = 'entry';
            entry.innerHTML = `
                <div class="mb-4">
                    <label data-i18n="authors_label" class="block text-sm font-medium text-gray-700 mb-2">作者（逗号分隔）</label>
                    <input type="text" name="publication_authors" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：张伟, 李明">
                </div>
                <div class="mb-4">
                    <label data-i18n="title_label" class="block text-sm font-medium text-gray-700 mb-2">标题</label>
                    <input type="text" name="publication_title" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：人工智能进展">
                </div>
                <div class="mb-4">
                    <label data-i18n="venue_label" class="block text-sm font-medium text-gray-700 mb-2">出版物</label>
                    <input type="text" name="publication_venue" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：NeurIPS">
                </div>
                <div class="mb-4">
                    <label data-i18n="year_label" class="block text-sm font-medium text-gray-700 mb-2">年份</label>
                    <input type="text" name="publication_year" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：2025">
                </div>
                <div class="mb-4">
                    <label data-i18n="url_label" class="block text-sm font-medium text-gray-700 mb-2">网址（可选）</label>
                    <input type="text" name="publication_url" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：https://arxiv.org/abs/1234.5678">
                </div>
                <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
            `;
            container.appendChild(entry);
            updateLanguage();
        }

        function addProject() {
            const container = document.getElementById('projectEntries');
            const entry = document.createElement('div');
            entry.className = 'entry';
            entry.innerHTML = `
                <div class="mb-4">
                    <label data-i18n="title_label" class="block text-sm font-medium text-gray-700 mb-2">标题</label>
                    <input type="text" name="project_title" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：AI图像生成项目">
                </div>
                <div class="mb-4">
                    <label data-i18n="descriptions_label" class="block text-sm font-medium text-gray-700 mb-2">描述（每行一条）</label>
                    <textarea name="project_descriptions" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：构建神经网络\n获奖"></textarea>
                </div>
                <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
            `;
            container.appendChild(entry);
            updateLanguage();
        }

        function addSkill() {
            const container = document.getElementById('skillEntries');
            const entry = document.createElement('div');
            entry.className = 'entry';
            entry.innerHTML = `
                <div class="mb-4">
                    <label data-i18n="category_label" class="block text-sm font-medium text-gray-700 mb-2">类别</label>
                    <input type="text" name="skill_category" data-i18n-placeholder="category_placeholder" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：编程语言">
                </div>
                <div class="mb-4">
                    <label data-i18n="items_label" class="block text-sm font-medium text-gray-700 mb-2">项目</label>
                    <input type="text" name="skill_items" data-i18n-placeholder="items_placeholder" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="例如：Python, Java">
                </div>
                <button type="button" data-i18n="remove_button" onclick="removeEntry(this)" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">移除</button>
            `;
            container.appendChild(entry);
            updateLanguage();
        }

        function removeEntry(button) {
            button.parentElement.remove();
        }

        document.getElementById('cvForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(this);
            const data = {
                language: formData.get('language'),
                Name: formData.get('Name'),
                Location: formData.get('Location'),
                Email: formData.get('Email'),
                Education: [],
                Experience: [],
                Publications: [],
                Projects: [],
                Skills: {}
            };

            // Collect Education
            const educationEntries = document.querySelectorAll('#educationEntries .entry');
            educationEntries.forEach(entry => {
                const education = {
                    institution: entry.querySelector('[name="education_institution"]').value,
                    duration: entry.querySelector('[name="education_duration"]').value,
                    degree: entry.querySelector('[name="education_degree"]').value
                };
                const extraFields = entry.querySelectorAll('.extra-field');
                extraFields.forEach(field => {
                    const key = field.querySelector('[name="education_extra_key"]').value;
                    const value = field.querySelector('[name="education_extra_value"]').value;
                    if (key && value) {
                        education[key] = value;
                    }
                });
                data.Education.push(education);
            });

            // Collect Experience
            const experienceEntries = document.querySelectorAll('#experienceEntries .entry');
            experienceEntries.forEach(entry => {
                const descriptions = entry.querySelector('[name="experience_descriptions"]').value
                    .split('\n')
                    .filter(desc => desc.trim() !== '');
                data.Experience.push({
                    affiliation: entry.querySelector('[name="experience_affiliation"]').value,
                    location: entry.querySelector('[name="experience_location"]').value,
                    duration: entry.querySelector('[name="experience_duration"]').value,
                    position: entry.querySelector('[name="experience_position"]').value,
                    descriptions: descriptions
                });
            });

            // Collect Publications
            const publicationEntries = document.querySelectorAll('#publicationEntries .entry');
            publicationEntries.forEach(entry => {
                const authors = entry.querySelector('[name="publication_authors"]').value
                    .split(',')
                    .map(author => author.trim());
                const publication = {
                    authors: authors,
                    title: entry.querySelector('[name="publication_title"]').value,
                    venue: entry.querySelector('[name="publication_venue"]').value,
                    year: entry.querySelector('[name="publication_year"]').value
                };
                const url = entry.querySelector('[name="publication_url"]').value;
                if (url) publication.url = url;
                data.Publications.push(publication);
            });

            // Collect Projects
            const projectEntries = document.querySelectorAll('#projectEntries .entry');
            projectEntries.forEach(entry => {
                const descriptions = entry.querySelector('[name="project_descriptions"]').value
                    .split('\n')
                    .filter(desc => desc.trim() !== '');
                data.Projects.push({
                    title: entry.querySelector('[name="project_title"]').value,
                    descriptions: descriptions
                });
            });

            // Collect Skills
            const skillEntries = document.querySelectorAll('#skillEntries .entry');
            skillEntries.forEach(entry => {
                const category = entry.querySelector('[name="skill_category"]').value;
                const items = entry.querySelector('[name="skill_items"]').value;
                data.Skills[category] = items;
            });

            // Send data to backend
            fetch('/generate_cv', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(translations[data.language].error_message + 'Failed to generate CV');
                }
                return response.blob();
            })
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'cv.pdf';
                a.click();
                window.URL.revokeObjectURL(url);
                const output = document.getElementById('output');
                output.textContent = translations[data.language].success_message;
                output.classList.remove('hidden');
            })
            .catch(error => {
                const output = document.getElementById('output');
                output.textContent = error.message;
                output.classList.remove('hidden');
            });
        });
    </script>
</body>
</html>